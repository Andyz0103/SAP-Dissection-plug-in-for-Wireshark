language: cpp
compiler:
  - clang
  - gcc
env:
  global:
    - WIRESHARK_BRANCH=master-1.10
  matrix:
    - BUILD_CMAKE=no
    - BUILD_CMAKE=yes
before_install: 
  - sudo apt-get update -qq
  - sudo apt-get install libglib2.0-dev libpcap-dev flex bison make -qq
  - sudo apt-get build-dep wireshark -qq
  - mkdir wireshark-$WIRESHARK_BRANCH
  - cd wireshark-$WIRESHARK_BRANCH
  - git init
  - git remote add -t $WIRESHARK_BRANCH -f origin https://github.com/wireshark/wireshark
  - git checkout $WIRESHARK_BRANCH
install:
  - mkdir plugins/sap
  - cp $TRAVIS_BUILD_DIR/* plugins/sap
  - git apply $TRAVIS_BUILD_DIR/wireshark.patch
  - if [ ${BUILD_CMAKE} == "yes" ]; then mkdir build && cd build && cmake ..; else ./autogen.sh && ./configure --with-gtk2; fi
script: 
  - make 
